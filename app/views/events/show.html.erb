<% nb_place = (@event.guests_number - @event.current_guests) %> 


<div class="showEvents">
	<div id="card"> 
		<p id="title"><%= @event.title %></p>
		<p id="subtitle"><%= @event.description %></p>
		<p id="subtitle"> C'est le <%= @event.date %></p>
		<p id="subtitle">Et c'est à <%= @event.city.city_name %> !</p>
	<% if nb_place > 0 && is_event_host(@event) == false %>
		<p id="subtitle">Il reste <%= nb_place %> place(s) disponible(s) !</p>
		<% if is_already_subscribed(current_user, @event) == false %>
			<%= button_to "Je veux venir !", '/appointment' , method: :post, params: {event_id: @event.id}, class:"jeveux" %>
		<% end %>
	<% elsif nb_place = 0 && is_event_host(@event) == false %>
		<p id="subtitle">Ce repas est complet !</p>
	<% else %>
		<p id="subtitle">Il reste <%= nb_place %> place(s) disponible(s) pour ton event !</p>
	<% end %>
	</div>
	<% if is_event_host(@event) == true %>
		<div>
			<h1>Voici les gens qui veulent rejoindre ton Event !</h1>
			<% @event.users.each do |user| %>
				<p><%= user.first_name%> <%=user.last_name%></p>
				<p><%= user.gender%> <%=user.age%></p>
				<% if user.appointments.where(event_id: @event.id).first.is_accepted?%>
					<p>Utilisateur déjà accepté ! </p>
				<%else%>	
					<% if (@event.current_guests < @event.guests_number)%>

						<%= button_to "Accepter l'invité", appointment_path(user.id), params:{event_id: @event.id, user_id: user.id}, method: :put %>
					<%end%>
				<%end%>
				<%= button_to "Refuser l'invité", appointment_path(user.id), params:{event_id: @event.id, user_id: user.id}, method: :delete %>
			<%end%>	
		</div>
	<%end%>	
</div>